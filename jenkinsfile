pipeline {
    agent {
        node {
            label "maven-slave"
        }
     }
environment {
    PATH = "/opt/apache-maven-3.8.8/bin:$PATH"
}
    stages {
        stage('Build') {
            steps {
                sh 'mvn clean deploy' 
            }
        }
      stage('SonarCloud') {
  environment {
    SCANNER_HOME = tool 'test-sonar-scanner'
    ORGANIZATION = "mydemoorg3"
    PROJECT_NAME = "mydemoproject3"
  }
  steps {
    withSonarQubeEnv('test-sonarqube-server') {
        sh '''$SCANNER_HOME/bin/sonar-scanner -Dsonar.organization=$ORGANIZATION \
        -Dsonar.java.binaries=build/classes/java/ \
        -Dsonar.projectKey=$PROJECT_NAME \
        -Dsonar.sources=.'''
    }
  }
}
}
